#!/usr/bin/env php
<?php
declare(strict_types = 1);

require __DIR__ . '/../vendor/autoload.php';

use PhpParser\ParserFactory;
use Recoil\Dev\Instrumentor;

$parser = (new ParserFactory)->create(ParserFactory::ONLY_PHP7);
$instrumentor = new Instrumentor($parser);

$source = __DIR__ . '/test.php';
$target = $source . '.instrumented';
file_put_contents($target, $instrumentor->instrument(file_get_contents($source)));
system("diff -u '$source' '$target'");
